<!DOCTYPE html>
<html>

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta http-equiv="Expires" content="0">
<meta http-equiv="Pragma" content="no-cache">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta http-equiv="Cache-Control"
	content="no-cache, no-store, must-revalidate">
<link rel="stylesheet" type="text/css" href="css/kaika.css" />
<link rel="stylesheet" type="text/css" href="css/base2015.css" />
<link rel="stylesheet" type="text/css" href="css/new_hf_2015.css" />
<link rel="stylesheet" type="text/css" href="css/sq_card_list.css" />
<link href="css/progressQuery.css" rel="stylesheet">
</head>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"
	rel="stylesheet">
<title>CCMS信用卡开卡中心</title>
<style type="text/css">
	.spa{
		color: red;
	}
</style>
</head>

<body>
	<div id="zt">
		<div class="container">
			<div class="row">
				<div style="margin-top: 40px;" class="col-md-12 col-md-offset-2">
					<div class="c-title-list" >
						<span style="font-size: 25px; font-family: '宋体';"> 信用卡开卡 </span>
					</div>
				</div>
			</div>
			<div id="activate" class="row">
				<div class="col-md-10 col-md-offset-2">
					<table>
						<tr>
							<td colspan="2" class="text-right">
								<hr class="hr" />
							</td>
						</tr>
						<tr>
							<td class="text-right"><span class="text">卡号： </span> <span
								class="span">*&nbsp;</span></td>
							<td><input name="activCardNum" type="text" style="border:none; background-color: #f9f9f9;"
								v-model="cardActiveLog.activCardNum" :value="cardActiveLog.activCardNum"
								readonly="readonly"/></td>
						</tr>
						<tr>
							<td class="text-right"><span class="text">身份证号码： </span> <span
								class="span">*&nbsp;</span></td>
							<td><input name="clientIDcard" type="text" id="clientIDcard" maxlength="18"
								v-model="cardActiveLog.clientIDcard" placeholder="18位数的身份证号码" @blur="blur1" />
								<span class="spa">{{a}}</span>
								<span v-text="msgs.msg1" class="spa spa4"></span>
							</td>
						</tr>
						<tr>
							<td class="text-right"><span class="text">有效期：</span> <span
								class="span">*&nbsp;</span></td>
							<td>
								<input type="date" class="demo-input" placeholder="yyyy-MM-dd" @blur="blur2"
								v-model="cardActiveLog.cardValidity" id="cardValidity" style="width: 183px;">
								<span class="spa">{{b}}</span>
								<span v-text="msgs.msg2" class="spa spa4"></span>
							</td>
						</tr>
						<tr>
							<td class="text-right"><span class="text">安全码：
							</span> <span class="span">*&nbsp;</span></td>
							<td><input name="cardSecurityCode" type="text" id="cardSecurityCode"
								v-model="cardActiveLog.cardSecurityCode" maxlength="3"
								placeholder="3位数字的安全码" @blur="blur3" />
								<span class="spa">{{c}}</span>
								<span v-text="msgs.msg3" class="spa spa4"></span>
							</td>
						</tr>
						<tr>
							<td class="text-right"><span class="text">手机号码： </span> <span
								class="span">*&nbsp;</span></td>
							<td><input name="clientPhone" type="text" id="clientPhone"
								v-model="cardActiveLog.clientPhone" maxlength="11"
								placeholder="11位数字的手机号码" @blur="blur4" />
								<span class="spa">{{d}}</span>
								<span v-text="msgs.msg4" class="spa spa4"></span>
						</tr>
						<tr>
							<td class="text-right"><span class="text">验证码： </span> <span
								class="span">*&nbsp;</span></td>
							<td><input class="input1" type="text" id="code_input" maxlength="6" placeholder="6位数验证码"
								value="" style="width: 85px;" /><span class="spa spa5"></span>&nbsp;&nbsp;
								<button style="margin-top: -2px;" type="button" id="btns"
									class="btn btn-danger btn-sm">
									&nbsp;&nbsp;免费获取&nbsp;&nbsp;</button></td>
						</tr>
						<tr>
							<td colspan="2">
								<button style="margin-left: 130px; margin-top: 10px; width: 150px;"
									type="submit" class="btn btn-danger btn-lg"
									@click="activateCreditCard()" id="button">
									&nbsp;&nbsp;&nbsp;&nbsp;确&nbsp;定&nbsp;&nbsp;&nbsp;&nbsp;
								</button>&nbsp;&nbsp;
							</td>
						</tr>
						<tr>
							<td colspan="2">
								<hr class="hr" />
							</td>
						</tr>
						<tr>
							<td colspan="2" class="">
								<div>
									<div>
										<input type="checkbox" checked="checked" style="float: left; margin-top: -3px;"/>
									</div>
									<div style="width: 750px;">
										我已阅读并清楚知晓 <a href="##">《CCMS信用卡网上领用协议》</a>及该信用卡的相关信息，
										并愿意遵守各项规则，保证预借现金仅用于合理、合规的消费领域，
										不得进入生产经营及证券市场，股本经营性投资及房地产开发等非消费领域。
									</div>
								</div>
							</td>
						</tr>
					</table>
				</div>
			</div>
		</div>
		<div style="margin-top: 260px;" class="footer_2014">
			<div class="left_con">
				<div class="link_area">
					<ul class="foot_link clearfix">
						<li><a href="http://creditcard.ecitic.com/guanyuwomen.shtml"
							target="_blank">关于我们</a></li>
						<li><a href="http://creditcard.ecitic.com/wenti/"
							target="_blank">常见问题</a></li>
						<li><a href="http://creditcard.ecitic.com/daohang.shtml"
							target="_blank">网站地图</a></li>
						<li><a href="http://creditcard.ecitic.com/lianxiwomen.shtml"
							target="_blank">联系我们</a></li>
						<li><a
							href="http://creditcard.ecitic.com/youqinglianjie.shtml"
							target="_blank">友情链接</a></li>
						<li><a href="http://creditcard.ecitic.com/h5/index.html"
							target="_blank">移动官网</a></li>
					</ul>
				</div>
				<p class="p_right">CCMS信用卡版权所有Copyright © 2002-2013 CITIC
					Holdings All rights reserved 京ICP证030779－1号</p>
			</div>
			<div class="right_con">
				<div class="service_tel">
					<p class="p1">24小时客服热线</p>
					<p class="p2">40088 - 95558</p>
				</div>
				<a class="ol_service"
					href="https://im.bank.ecitic.com/credit/navigation.html?channel=712021"
					style="background: url('') no-repeat;" target="_blank"><img
					alt="" src="img/kf_icon.png" style="margin-left: 11px"> <br>
					在线客服 </a>
			</div>
			<div class="c"></div>
		</div>
		<div class="c"></div>
	</div>
	<script
		src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/cards_list.js"></script>
	<script type="text/javascript" src="js/nav.js"></script>
	<script type="text/javascript" src="js/h.js"></script>
	<script type="text/javascript" src="js/vuejs-2.5.16.js"></script>
	<script type="text/javascript" src="js/axios-0.18.0.js"></script>
	<script src="https://cdn.bootcss.com/vue/2.5.17-beta.0/vue.min.js"></script>
	<script type="text/javascript" src="js/ol_service.js"></script>
	<script type="text/javascript" src="js/urchin.js"></script>
	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" src="js/laydate/laydate.js"></script>
	<script type="text/javascript">
		new Vue({
            el:'#activate',
            data:{
            	creditCard:{
            		id:'',
            		cardNum:'',
            		cardValidity:'',
            		cardSecurityCode:'',
            		cardPhone:''
            	},
            	cardActiveLog:{
            		id:'',
            		clientIDcard:'',
            		activCardNum:'',
            		cardValidity:'',
            		cardSecurityCode:'',
            		clientPhone:''
                },
                a:'',
				b:'',
				c:'',
				d:'',
				names: "@blur_61",
                msgs:{}
            },
            methods:{
            	selectCreditCardById: function(){
            		var _this=this;
            		var id=_this.cardActiveLog.id;
            		axios.get('http://10.1.12.66:8086/cardmanger/selectCreditCardById',{params:{id:id}})
            		 .then(function (response) {
            			 _this.creditCard.cardNum=response.data.cc.cardNum;
            			 _this.cardActiveLog.activCardNum=_this.creditCard.cardNum;
                         _this.creditCard=response.data.cc;
                        	console.log(response.data.cc);
                      })
            	},
            	blur1(){
            		var _this=this;
            		var num=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;
					if(_this.cardActiveLog.clientIDcard==""){
            			this.a="*身份证号码不能为空！";
            			return false
            		}
            		if(!num.test(_this.cardActiveLog.clientIDcard)){
            			this.a="*身份证号码格式错误！";
            			return false
            		}
            		if(_this.cardActiveLog.clientIDcard!=""){
            			this.a="";
            		}
            		if(num.test(_this.cardActiveLog.clientIDcard)){
            			this.a="";
            		}
            	},
				blur2(){
            		var _this=this;
					if(_this.cardActiveLog.cardValidity==""){
            			this.b="*有效期不能为空！";
            			return false
            		}
            		if(_this.cardActiveLog.cardValidity!=""){
            			this.b="";
            		}
            	},
				blur3(){
            		var _this=this;
            		var code=/^\d{3}$/;
					if(_this.cardActiveLog.cardSecurityCode==""){
            			this.c="*安全码不能为空！";
            			return false
            		}
            		if(!code.test(_this.cardActiveLog.cardSecurityCode)){
            			this.c="*安全码格式错误！";
            			return false
            		}
            		if(_this.cardActiveLog.cardSecurityCode!=""){
            			this.c="";
            		}
            		if(code.test(_this.cardActiveLog.cardSecurityCode)){
            			this.c="";
            		}
            	},
				blur4(){
            		var _this=this;
					var tex=/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/;
					if(_this.cardActiveLog.clientPhone==""){
            			this.d="手机号码不能为空！";
            			return false
            		}
            		if(!tex.test(_this.cardActiveLog.clientPhone)){
            			this.d="手机号码格式错误！";
            			return false
            		}
            		if(_this.cardActiveLog.clientPhone!=""){
            			this.d="";
            		}
            		if(tex.test(_this.cardActiveLog.clientPhone)){
            			this.d="";
            		}
            	},
            	activateCreditCard(){
            		var _this=this;
            		if(_this.cardActiveLog.clientIDcard=="" ||
						_this.cardActiveLog.cardValidity=="" ||
						_this.cardActiveLog.cardSecurityCode=="" ||
						_this.cardActiveLog.clientPhone==""){
						if(_this.cardActiveLog.clientIDcard==""){
            				this.a="*身份证号码不能为空！";
	            		}
						if(_this.cardActiveLog.cardValidity==""){
							this.b="*有效期不能为空！";
            			}
						if(_this.cardActiveLog.cardSecurityCode==""){
	            			this.c="*安全码不能为空！";
	            		}
						if(_this.cardActiveLog.clientPhone==""){
	            			this.d="手机号码不能为空！";
	            		}
						alert("请先填写完信息，再提交！")
					}else{
						axios.get('http://10.1.12.66:8086/cardmanger/activateCreditCard', {'params':{'id':_this.cardActiveLog.id,
            			'clientIDcard':_this.cardActiveLog.clientIDcard,
            			'activCardNum':_this.cardActiveLog.activCardNum,
            			'cardValidity':_this.cardActiveLog.cardValidity,
            			'cardSecurityCode':_this.cardActiveLog.cardSecurityCode,
            			'clientPhone':_this.cardActiveLog.clientPhone}
                      })
                      .then(res=>{
				    	    console.log(res.data)
				    	    this.msgs=res.data
				    	    if(this.msgs.no==400){
				    	    	alert("激活失败！只有未激活的信用卡才能开卡！")
				    	    }
				    	    if(this.msgs.ok==200){
				    	    	document.location="http://10.1.12.66:8086/cardmanger/openCreditCardTwo.html";
				    	    }
				    	})
                      .catch(function (error) {
                        	console.log(error);
                    	})
					}
            		
                },
            },
            created:function(){
            	this.cardActiveLog.id = localStorage.getItem("cid");
            	console.log(this.cardActiveLog.id)
            	this.selectCreditCardById();
            },
        });
	</script>
</body>

</html>