<!DOCTYPE html>
<!-- saved from url=(0066)https://creditcard.ecitic.com/citiccard/ebankpc/settingManage.html -->
<html lang="zh-cn">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta http-equiv="Expires" content="0">
<meta http-equiv="Pragma" content="no-cache">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta http-equiv="Cache-Control"
	content="no-cache, no-store, must-revalidate">
<title>设置管理-通用设置</title>
<link rel="shortcut icon"
	href="https://creditcard.ecitic.com/citiccard/ebankpc/logo.ico">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link href="css/settingManage.7e62b685.css" rel="stylesheet">
<style type="text/css">
.spa{
	color: red;
}
</style>
</head>

<body>
<div id="cancel">
	<div class="header">
		<div class="content">
			<a href="http://creditcard.ecitic.com/" title="中信银行信用卡中心官网"
				target="_blank" class="logo-area"> <img src="img/logo白色.png">
			</a>
			<div class="menu-area">
				<span>欢迎您，<strong id="userName">{{name}}</strong></span> <span
					class="line">|</span> <img class="online-server"
					id="online-server-img" src="img/kf.gif" alt="在线客服"> <span
					class="line">|</span> <img class="security-logout" src="img/gb.gif"
					alt="安全退出" id="logout">
			</div>
		</div>
	</div>
	<div class="menu">
		<ul>
			<li class="yahei" id="yahei01"><a href="loginIndex.html"
				class="wdzh" target="_self">我的账户</a></li>
			<li class="yahei" id="yahei02"><a href="bill.html" class="zdcx"
				target="_self">账单查询</a></li>
			<li class="yahei" id="yahei03"><a href="repay.html"
				class="xykhk" target="_self">信用卡还款</a></li>
			<li class="yahei" id="yahei04"><a href="aging.html" class="fqyw"
				target="_self">分期业务</a></li>
			<li class="yahei" id="yahei07"><a href="http://10.1.12.66:8086/cardmanger/creditCardManager.html"
				class="szgl" target="_self">设置管理</a></li>
		</ul>
	</div>

	<div class="main_top">
		<img style="padding-left: 793px; margin-top: -7px" src="img/jt.gif">
	</div>
	<div class="main" id="mainSettingManage">
		<div class="sub_menu">
			<a class="hover" href="device.html" target="_self">基本信息</a>
			<a href="http://10.1.12.66:8086/cardmanger/creditCardManager.html" target="_self">信用卡管理</a>
		</div>
		<div class="password_reset" id="passwordSet" style="">
			<div class="title password_set_title">信用卡注销</div>
			<div class="password_set_content">
				<div v-for="(ccs,index) in showCard">
						<div class="password_set_card" id="passwordSetCard">
							<div class="card_content" style="float: left">
								<div class="card_sub_content" style="background:#336699;">
									<p class="card_desc" style="height: 34px;">{{ccs.cardType}}</p>
									<p class="card_tail">{{ccs.cardNum}}</p>
									<p style="border: 1px solid #FFFFFF;
										width: 50px; height: 23px; text-align: center;
										margin-left: 21px;">{{ccs.cardState}}
									</p>
									<p class="card_logo"><img src="img/yinlian.gif" width="75" height="44"></p>
								</div>
								<p class="select_card" style="display: block;"></p>
							</div>
						</div>
					</div>
					<span class="xing">*</span>身份证号<br />
						<input class="pad" type="text" name="clientIDcard" @blur="blur1"
						v-model="cancelCard.clientIDcard" maxlength="18" placeholder="18位数的身份号码"  />
						<span class="spa">{{a}}</span>
						<span v-text="msgs.msg1" class="spa spa2"></span> <br />
					<span class="xing">*</span>手机号<br />
						<input class="pad" type="text" name="clientPhone" @blur="blur2"
						v-model="cancelCard.clientPhone" maxlength="11" placeholder="11位数字的手机号码" />
						<span class="spa">{{b}}</span>
						<span v-text="msgs.msg2" class="spa spa2"></span> <br />
					<span class="xing">*</span>验证码<br />
						<input class="pad" style="width: 70px;" type="text" name="code"
							maxlength="6" placeholder="6位数字的验证码" />
					<button style="margin-top: -5px; width: 77px;"
						 type="button" id="but"
						class="btn btn-danger btn-sm" @click="cancelCreditCard()">&nbsp;免费获取&nbsp;
					</button>
					<div class="password_set_btn">
						<button @click="cancelCreditCard()" id="but" class="btn btn-danger btn-sm">
							&nbsp;&nbsp;&nbsp;&nbsp;确 定&nbsp;&nbsp;&nbsp;&nbsp;
						</button>
					</div>
			</div>
		</div>
	</div>
	<div id="tishi" style=" float: left; margin-top: 20px;  margin-left: 584px;">
			<span style="color: #E60008; font-size: 16px;">注意事项：</span>
			<p>
				<br />
				<span style="font-size: 15px;"> 
					● 需要将信用卡的欠款余额还清，保证信用卡内无欠款。<br style="margin-bottom: 10px;">
					● 如果信用卡内有多余存款，也需要将存款取出来或者是消费掉。<br style="margin-bottom: 10px;">
					● 信用卡内既无欠款又无存款的情况下，可直接拨打客服热线申请注销<br style="margin-bottom: 10px;">
					● 信用卡注销成功后，银行工作人员会电话或短信通知您。
				</span>
		</div>
	<div class="footer" id="footer_b" style="margin-top: 350px;">
		<ul class="footer_list">
			<li class="footer_cr">
				<p>CCSM信用卡股份有限公司授权所有Copyright 2002-2019 CITIC BANK ALL rights
					reserved</p>
				<p>京公网安备11010502020433号 京ICP证 030779-1号</p>
			</li>
			<li class="footer_line">
				<p class="tip">24小时客服热线</p>
				<p class="number">40088 - 95558</p>
			</li>
			<li class="footer_client" id="footer_client"><a><img
					id="my_footer" src="img/kf_icon.png" alt="客服"></a>
				<p>在线客服</p></li>
		</ul>
	</div>
</div>
	<script src="js/settingManage.7e62b685.js"></script>
	<script type="text/javascript" src="js/dll.vendors.47a4bc191c19df35baf4.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/vuejs-2.5.16.js"></script>
	<script type="text/javascript" src="js/axios-0.18.0.js"></script>
	<script src="https://cdn.bootcss.com/vue/2.5.17-beta.0/vue.min.js"></script>
	<script type="text/javascript">	
		new Vue({
            el:'#cancel',
            data:{
            	creditCard:{
            		id:'',
            		cardNum:'',
            		cardValidity:'',
            		cardSecurityCode:'',
            		cardPhone:''
            	},
            	cancelCard:{
            		id:'',
            		removeCardId:'',
            		clientIDcard:'',
            		clientPhone:''
                },
                showCard:[],
                name:'',
                a:'',
				b:'',
				names: "@blur_61",
                msgs:{}
            },
            methods:{
            	blur1(){
    				var _this=this;
    				var num=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;
    				if(_this.cancelCard.clientIDcard==""){
                			this.a="*身份证号码不能为空！";
                			return false
               		}
               		if(!num.test(_this.cancelCard.clientIDcard)){
               			this.a="*身份证号码格式错误！";
               			return false
               		}
               		if(_this.cancelCard.clientIDcard!=""){
               			this.a="";
               		}
               		if(num.test(_this.cancelCard.clientIDcard)){
               			this.a="";
               		}
    			},
    			blur2(){
    				var _this=this;
    				var tex=/^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$/;	
    				if(_this.cancelCard.cardPhone==""){
               			this.b="*手机号码不能为空！";
               			return false
               		}
               		if(!tex.test(_this.cancelCard.cardPhone)){
               			this.b="*手机号码格式错误！";
               			return false
               		}
               		if(_this.cancelCard.cardPhone!=""){
               			this.b="";
               		}
               		if(tex.test(_this.cancelCard.cardPhone)){
               			this.b="";
               		}
    			},
            	selectCreditCardById: function(){
            		var _this=this;
            		var idc= GetQueryString("id")
            		var id=_this.cancelCard.id;
            		axios.get('http://10.1.12.66:8086/cardmanger/selectCreditCardById',{params:{id:idc}})
            		 .then(function (response) {
            			 _this.showCard = response.data.scs;
            			 _this.name=response.data.name;
            			 _this.creditCard.cardNum=response.data.cc.cardNum;
            			 _this.cancelCard.removeCardId=_this.creditCard.cardNum;
                        _this.creditCard=response.data.cc;
                        	console.log(response.data.cc);
                      })
            	}, 
            	cancelCreditCard(){
            		var _this=this;
            		if(_this.cancelCard.clientIDcard=="" ||
   						_this.cancelCard.cardPhone==""){
   						if(_this.cancelCard.clientIDcard!=""){
   	            			this.a="";
   	           			}
   						if(_this.cancelCard.cardPhone!=""){
   			           		this.b="";
              				}
   						alert("请先填写完信息，再提交！")
               		}else{
               			axios.get('http://10.1.12.66:8086/cardmanger/cancelCreditCard', {'params':{'id':_this.cancelCard.id,
                			'removeCardId':_this.cancelCard.removeCardId,
                			'clientIDcard':_this.cancelCard.clientIDcard,
                			'clientPhone':_this.cancelCard.clientPhone}
                          })
                          .then(res=>{
    				    	    console.log(res.data)
    				    	    this.msgs=res.data
    				    	    if(this.msgs.no==400){
    				    	    	alert("销卡失败！卡上有余额，不能销卡！")
    				    	    	document.location="http://10.1.12.66:8086/cardmanger/creditCardManager.html";
    				    	    }
    				    	    if(this.msgs.no==401){
    				    	    	alert("销卡失败！卡上有欠款，不能销卡！")
    				    	    	document.location="http://10.1.12.66:8086/cardmanger/creditCardManager.html";
    				    	    }
    				    	    if(this.msgs.ok==200){
    				    	    	alert("销卡成功！")
    				    	    	document.location="http://10.1.12.66:8086/cardmanger/creditCardManager.html";
    				    	    }
    				    	})
                         .catch(function (error) {
                           console.log(error);
                         })
    				}
                },
            },
            created:function(){
            	this.selectCreditCardById();
            	this.cancelCard.id = localStorage.getItem("cid");
            	console.log(this.cancelCard.id)
            },
        });
		function GetQueryString(name){
		     var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
		     var r = window.location.search.substr(1).match(reg);
		     if(r!=null)return  unescape(r[2]); return null;
		}
		</script>
</body>

</html>